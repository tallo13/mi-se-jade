<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Interactive food places in Kavadarci, Macedonia. Search by menu items and find restaurants, fast food, and bakeries.">
  <meta name="keywords" content="Kavadarci food, restaurants Kavadarci, pizza Kavadarci, burek Kavadarci, map">
  <meta property="og:title" content="Food Map of Kavadarci">
  <meta property="og:description" content="Find the best food places in Kavadarci with menus and locations.">
  <meta property="og:image" content="https://tallo13.github.io/mi-se-jade/map-preview.jpg"> <!-- Replace with a real image URL if you add one later -->
  <meta property="og:url" content="https://tallo13.github.io/mi-se-jade">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="google-site-verification" content="oExMqB6xdh0CLQyQNOS4r-OR5jaiH8BXiub4ubuZjQk" />
  <title>Food Map of Kavadarci - Ми се јаде</title>
  <style>
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .items-center { align-items: center; }
    .min-h-screen { min-height: 100vh; }
    .mt-8 { margin-top: 2rem; }
    .w-full { width: 100%; }
    .max-w-md { max-width: 28rem; }
    .text-white { color: white; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .rounded-l-md { border-top-left-radius: 0.375rem; border-bottom-left-radius: 0.375rem; }
    .rounded-r-md { border-top-right-radius: 0.375rem; border-bottom-right-radius: 0.375rem; }
    .flex-grow { flex-grow: 1; }
    .p-2 { padding: 0.5rem; }
    .border-2 { border-width: 2px; }
    .focus\:outline-none:focus { outline: none; }
    .text-xl { font-size: 1.25rem; }
    .text-lg { font-size: 1.125rem; }
    .font-bold { font-weight: bold; }
    .text-green-800 { color: #166534; }
    .text-sm { font-size: 0.875rem; }
    .text-gray-600 { color: #4B5563; }
    .font-semibold { font-weight: 600; }
    .text-red-500 { color: #EF4444; }
    .text-green-600 { color: #059669; }
    .text-blue-500 { color: #3B82F6; }
    .text-gray-500 { color: #6B7280; }
    .hover\:underline:hover { text-decoration: underline; }
    .mt-1 { margin-top: 0.25rem; }
    .inline-block { display: inline-block; }
    .mt-2 { margin-top: 0.5rem; }
    .text-green-700 { color: #15803D; }
    .text-center { text-align: center; }
    .col-span-full { grid-column: 1 / -1; }
  <style>
    body {
      background: linear-gradient(135deg, #e8f5e8 0%, #f0f9f0 50%, #e0f2e0 100%);
      min-height: 100vh;
      overflow-x: hidden;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    .food-button { background-color: #22C55E; }
    .food-button:hover { background-color: #16A34A; }
    input { border-color: #22C55E; }
    
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }
    
    .search-container {
      position: relative;
      width: 100%;
      max-width: 400px;
      margin: 1rem auto 2rem auto;
    }
    
    #clearSearch {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #22C55E;
      font-weight: bold;
      z-index: 10;
      font-size: 1.5rem;
    }
    
    .search-container input {
      padding-right: 3rem;
    }
    
    #cards-container {
      width: 100%;
      display: grid;
      gap: 1rem;
      grid-template-columns: 1fr;
    }
    
    /* Mobile view - vertical cards */
    @media (max-width: 768px) {
      #cards-container {
        grid-template-columns: 1fr;
      }
      .card {
        width: 100%;
      }
    }
    
    /* Tablet view - 2 columns */
    @media (min-width: 769px) and (max-width: 1024px) {
      #cards-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    /* Desktop view - calendar-like tile layout */
    @media (min-width: 1025px) {
      #cards-container {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    .card {
      background: white;
      border-radius: 0.5rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    .expand-button {
      cursor: pointer;
      padding: 0.5rem;
      background-color: #F3F4F6;
      border-radius: 0.375rem;
      margin-top: 0.5rem;
      transition: background-color 0.2s;
      display: flex;
      align-items: center;
    }
    
    .expand-button:hover {
      background-color: #E5E7EB;
    }
    
    .expand-triangle {
      width: 0;
      height: 0;
      border-left: 5px solid #6B7280;
      border-top: 5px solid transparent;
      border-bottom: 5px solid transparent;
      margin-right: 0.5rem;
      transition: transform 0.2s;
    }
    
    .expand-button.expanded .expand-triangle {
      transform: rotate(90deg);
    }
    
    .menu-items-list {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
      background-color: #F9FAFB;
      border-radius: 0.375rem;
      margin-top: 0.25rem;
    }
    
    .menu-items-list.expanded {
      padding: 0.5rem;
    }
    
    .menu-items-list div {
      padding: 0.25rem 0;
      border-bottom: 1px solid #E5E7EB;
    }
    
    .menu-items-list div:last-child {
      border-bottom: none;
    }
    
    .google-maps-link {
      color: #2563eb;
      text-decoration: none;
      font-size: 0.875rem;
      margin-top: 0.5rem;
      display: inline-block;
    }
    
    .google-maps-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body class="flex flex-col items-center min-h-screen">
  <div class="container">
    <div class="flex mt-8 w-full max-w-md search-container">
      <button id="searchButton" class="food-button text-white px-4 py-2 rounded-l-md">
        Ми се јаде
      </button>
      <input id="searchInput" type="text" placeholder="Пишете пример: пица, плескавица)" 
             class="flex-grow p-2 rounded-r-md border-2 focus:outline-none">
      <span id="clearSearch" class="text-xl">×</span>
    </div>
    <div id="cards-container"></div>
  </div>

  <script>
    // Real data for Kavadarci food places
    const foodPlaces = [
      {
        name: "Pizza 'Jakomo'",
        lat: 41.4358405,
        lng: 22.0110744,
        menus: [
          { category: "Пица", items: [{ name: "Маргарита", price: "310 ден" }, { name: "Пеперони", price: "360 ден" }, { name: "Капричоза", price: "340 ден" }] },
          { category: "Сендвич", items: [{ name: "Романо", price: "190 ден" }, { name: "Милано", price: "170 ден" }] },
          { category: "Пита", items: [{ name: "Свинска", price: "190 ден" }, { name: "Пилешка", price: "170 ден" }] }
        ],
        phone: "071 492 216",
        opening_hours: [
          "Monday: 8:00 AM – 12:00 AM",
          "Tuesday: 8:00 AM – 12:00 AM",
          "Wednesday: 8:00 AM – 12:00 AM",
          "Thursday: 8:00 AM – 12:00 AM",
          "Friday: 8:00 AM – 1:00 AM",
          "Saturday: 8:00 AM – 1:00 AM",
          "Sunday: 5:00 PM – 11:59 PM"
        ],
        url: "https://pizzajakomo.com"
      },
      {
        name: "Grill 'Diroko'",
        lat: 41.4336845,
        lng: 22.0110333,
        menus: [
          { category: "Скара", items: [{ name: "Ќебап", price: "15 ден" }, { name: "Плескавица", price: "100 ден" }] }
        ],
        phone: "043 417 311",
        opening_hours: [
          "Monday: 8:00 AM – 10:00 PM",
          "Tuesday: 8:00 AM – 10:00 PM",
          "Wednesday: 8:00 AM – 10:00 PM",
          "Thursday: 8:00 AM – 10:00 PM",
          "Friday: 8:00 AM – 10:00 PM",
          "Saturday: 8:00 AM – 10:00 PM",
          "Sunday: 8:00 AM – 10:00 PM"
        ],
        url: ""
      },
      {
        name: "Burek Kiosks",
        lat: 41.4333,
        lng: 22.0114,
        menus: [
          { category: "Бурек", items: [{ name: "Бурек со месо", price: "100 ден" }, { name: "Бурек со сирење", price: "90 ден" }] }
        ],
        phone: "",
        opening_hours: [
          "Monday: 6:00 AM – 12:00 PM",
          "Tuesday: 6:00 AM – 12:00 PM",
          "Wednesday: 6:00 AM – 12:00 PM",
          "Thursday: 6:00 AM – 12:00 PM",
          "Friday: 6:00 AM – 12:00 PM",
          "Saturday: 6:00 AM – 12:00 PM",
          "Sunday: 7:00 AM – 11:00 AM"
        ],
        url: ""
      },
      {
        name: "Hotel Restaurant 'Exclusive'",
        lat: 41.430635,
        lng: 22.005234,
        menus: [
          {
            "category": "Предјадења",
            "items": [
              { "name": "Шопска салата", "price": "160 ден." },
              { "name": "Мешана салата", "price": "140 ден." },
              { "name": "Цезар салата со пилешко", "price": "210 ден." },
              { "name": "Макарона салата", "price": "150 ден." },
              { "name": "Руска салата", "price": "150 ден." },
              { "name": "Грчка салата", "price": "180 ден." },
              { "name": "Зелена салата", "price": "80 ден." },
              { "name": "Домати салата", "price": "100 ден." },
              { "name": "Краставица салата", "price": "100 ден." },
              { "name": "Сирење и домати", "price": "180 ден." },
              { "name": "Исклучително мешано мезе", "price": "800 ден." },
              { "name": "Домашно мешано мезе", "price": "600 ден." },
              { "name": "Мезе за двајца", "price": "450 ден." },
              { "name": "Мезе за еден", "price": "250 ден." },
              { "name": "Тиквички во сос", "price": "160 ден." },
              { "name": "Печена пиперка", "price": "130 ден." },
              { "name": "Урнебес", "price": "130 ден." },
              { "name": "Пинџур", "price": "120 ден." },
              { "name": "Кајмак", "price": "100 ден." },
              { "name": "Зелени маслинки", "price": "80 ден." },
              { "name": "Мешани кисели краставички", "price": "80 ден." },
              { "name": "Сирење", "price": "80/150 ден." },
              { "name": "Кашкавал", "price": "100/180 ден." }
            ]
          },
          {
            "category": "Чорби",
            "items": [
              { "name": "Пилешка чорба", "price": "100 ден." },
              { "name": "Говедска чорба", "price": "110 ден." },
              { "name": "Телешка чорба", "price": "120 ден." },
              { "name": "Рибна чорба", "price": "160 ден." },
              { "name": "Чорба од печурки", "price": "120 ден." }
            ]
          },
          {
            "category": "Од скара",
            "items": [
              { "name": "Ќебапчиња", "price": "200 ден." },
              { "name": "Плескавица", "price": "200 ден." },
              { "name": "Пилешко месо", "price": "220 ден." },
              { "name": "Свинско месо", "price": "200 ден." },
              { "name": "Телешко месо", "price": "380 ден." },
              { "name": "Свински котлет", "price": "240 ден." },
              { "name": "Пилешки стек", "price": "250 ден." },
              { "name": "Пилешка пржолица", "price": "200 ден." },
              { "name": "Свинска пржолица", "price": "280 ден." },
              { "name": "Телешка пржолица", "price": "450 ден." },
              { "name": "Свински врат", "price": "270 ден." },
              { "name": "Шиш", "price": "280 ден." },
              { "name": "Мешано месо", "price": "350 ден." },
              { "name": "Вешалица", "price": "360 ден." },
              { "name": "Мешано месо за двајца", "price": "650 ден." },
              { "name": "Мешано месо за тројца", "price": "950 ден." },
              { "name": "Мешано месо за четворица", "price": "1200 ден." },
              { "name": "Ребрица", "price": "320 ден." },
              { "name": "Ќуфте", "price": "200 ден." },
              { "name": "Колбасица", "price": "200 ден." },
              { "name": "Пржени колбасици", "price": "200 ден." },
              { "name": "Луканец", "price": "220 ден." }
            ]
          },
          {
            "category": "Риба",
            "items": [
              { "name": "Пастрмка", "price": "350 ден." },
              { "name": "Шаран", "price": "250 ден." },
              { "name": "Морски јазик", "price": "320 ден." },
              { "name": "Царска риба", "price": "300 ден." },
              { "name": "Лигна", "price": "280 ден." },
              { "name": "Скуша", "price": "240 ден." },
              { "name": "Ослич", "price": "300 ден." }
            ]
          },
          {
            "category": "Традиционални јадења",
            "items": [
              { "name": "Тавче гравче", "price": "180 ден." },
              { "name": "Сарма", "price": "200 ден." },
              { "name": "Мусака", "price": "200 ден." },
              { "name": "Полнети пиперки", "price": "200 ден." },
              { "name": "Полнети тиквички", "price": "200 ден." },
              { "name": "Селска манџа", "price": "250 ден." },
              { "name": "Јагнешко со зеленчук", "price": "280 ден." },
              { "name": "Елбасан тава", "price": "240 ден." },
              { "name": "Гувеч", "price": "200 ден." },
              { "name": "Јарешко со зеленчук", "price": "280 ден." }
            ]
          },
          {
            "category": "Пилешки специјалитети",
            "items": [
              { "name": "Пилешко во кари", "price": "280 ден." },
              { "name": "Пилешко со печурки", "price": "300 ден." },
              { "name": "Пилешко со ананас", "price": "300 ден." },
              { "name": "Пилешко во фолија", "price": "320 ден." },
              { "name": "Пилешко со зеленчук", "price": "280 ден." },
              { "name": "Пилешко со портокал", "price": "330 ден" }
            ]
          },
          {
            "category": "Прилози",
            "items": [
              { "name": "Фурнарини", "price": "60 ден." },
              { "name": "Пикантни фурнарини", "price": "70 ден." },
              { "name": "Фурнарина со сирење и лук", "price": "120 ден." },
              { "name": "Домашно лебче", "price": "25 ден." },
              { "name": "Домашно лебче со кајмак, сусам, лук и оригано", "price": "150 ден." },
              { "name": "Домашно лебче со моцарела и лук", "price": "160 ден." },
              { "name": "Помфрит", "price": "60/120 ден." },
              { "name": "Помфрит со сирење", "price": "100/160 ден." },
              { "name": "Рижото со зеленчук", "price": "180 ден." },
              { "name": "Бел ориз", "price": "80 ден." },
              { "name": "Вариво", "price": "60 ден." },
              { "name": "Гарнир", "price": "40/50/60 ден." },
              { "name": "Прелив со печурки", "price": "60 / 120 ден." },
              { "name": "Пиперка", "price": "20/30/40 ден." },
              { "name": "Преливи, сосови, дресинзи", "price": "60/80 ден." }
            ]
          }
        ],
        phone: "043 411 561",
        opening_hours: [
          "Monday: 8:00 AM – 12:00 AM",
          "Tuesday: 8:00 AM – 12:00 AM",
          "Wednesday: 8:00 AM – 12:00 AM",
          "Thursday: 8:00 AM – 12:00 AM",
          "Friday: 8:00 AM – 12:00 AM",
          "Saturday: 8:00 AM – 1:00 AM",
          "Sunday: 8:00 AM – 1:00 AM"			
        ],
        url: "https://www.restoranexclusive.mk/meni/"
      },
      {
        name: "Restaurant 'Kalimero'",
        lat: 41.4342682,
        lng: 22.018601,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Ladno Dolce",
        lat: 41.4343592,
        lng: 22.0193361,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Restaurant 'Buki'",
        lat: 41.4326697,
        lng: 22.0111956,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Restaurant 'Madzirka'",
        lat: 41.4342516,
        lng: 22.0193508,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "LAGUNA Lucnh",
        lat: 41.4322886,
        lng: 22.0128944,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Kafana 'Tabak'",
        lat: 41.4323517,
        lng: 22.0154697,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Restaurant 'Staro Maalo'",
        lat: 41.4320154,
        lng: 22.0134477,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Fast food 'Cambridge'",
        lat: 41.4412024,
        lng: 22.0196814,
        menus: [],
        phone: "072 205 289",
        opening_hours: [],
        url: ""
      },
      {
        name: "Fast Food 'Famosita'",
        lat: 41.43357049999999,
        lng: 22.0083618,
        menus: [],
        phone: "078 396 111",
        opening_hours: [
          "Monday: 6:00 AM – 12:00 PM",
          "Tuesday: 6:00 AM – 12:00 PM",
          "Wednesday: 6:00 AM – 12:00 PM",
          "Thursday: 6:00 AM – 12:00 PM",
          "Friday: 6:00 AM – 12:00 PM",
          "Saturday: 6:00 AM – 12:00 PM",
          "Sunday: Closed"
        ],
        url: ""
      },
      {
        name: "Pizza Restaurant Fantasy",
        lat: 41.4325739,
        lng: 22.0182189,
        menus: [],
        phone: "043 550 088",
        opening_hours: [
          "Monday: 8:00 AM – 12:00 AM",
          "Tuesday: 8:00 AM – 12:00 AM",
          "Wednesday: 8:00 AM – 12:00 AM",
          "Thursday: 8:00 AM – 12:00 AM",
          "Friday: 8:00 AM – 12:00 AM",
          "Saturday: 8:00 AM – 12:00 AM",
          "Sunday: 8:00 AM – 12:00 AM"
        ],
        url: ""
      },
      {
        name: "Ресторан Бриони - Restoran Brioni",
        lat: 41.4346733,
        lng: 22.0215274,
        menus: [],
        phone: "078 218 900",
        opening_hours: [
          "Monday: 8:00 AM – 12:00 AM",
          "Tuesday: 8:00 AM – 12:00 AM",
          "Wednesday: 8:00 AM – 12:00 AM",
          "Thursday: 8:00 AM – 12:00 AM",
          "Friday: 8:00 AM – 1:00 AM",
          "Saturday: 8:00 AM – 1:00 AM",
          "Sunday: 8:00 AM – 12:00 AM"
        ],
        url: ""
      },
      {
        name: "El Gurman (skara i gostilnica)",
        lat: 41.4422387,
        lng: 22.007409,
        menus: [],
        phone: "078 507 407",
        opening_hours: [
          "Monday: 9:00 AM – 10:00 PM",
          "Tuesday: 9:00 AM – 10:00 PM",
          "Wednesday: 9:00 AM – 10:00 PM",
          "Thursday: 9:00 AM – 10:00 PM",
          "Friday: 9:00 AM – 12:00 AM",
          "Saturday: 11:00 AM – 12:00 AM",
          "Sunday: Closed"
        ],
        url: ""
      },
      {
        name: "Pod lipite",
        lat: 41.4306674,
        lng: 22.0108911,
        menus: [],
        phone: "",
        opening_hours: [
          "Monday: Closed",
          "Tuesday: Closed",
          "Wednesday: Closed",
          "Thursday: Closed",
          "Friday: Closed",
          "Saturday: Closed",
          "Sunday: 9:00 AM – 12:00 AM"
        ],
        url: ""
      },
      {
        name: "Restaurant Angro Kids",
        lat: 41.4394067,
        lng: 22.0023205,
        menus: [],
        phone: "",
        opening_hours: [],
        url: ""
      },
      {
        name: "Hotel & Restaurant 'Elitte'",
        lat: 41.4417405,
        lng: 21.9978522,
        menus: [],
        phone: "075 416 425",
        opening_hours: [
          "Monday: Open 24 hours",
          "Tuesday: Open 24 hours",
          "Wednesday: Open 24 hours",
          "Thursday: Open 24 hours",
          "Friday: Open 24 hours",
          "Saturday: Open 24 hours",
          "Sunday: Open 24 hours"
        ],
        url: ""
      },
      {
        name: "Сендвичара 'Ѕвончица'",
        lat: 41.4219102,
        lng: 22.0153466,
        menus: [],
        phone: "071 206 947",
        opening_hours: [
          "Monday: 7:00 AM – 12:00 AM",
          "Tuesday: 7:00 AM – 12:00 AM",
          "Wednesday: 7:00 AM – 12:00 AM",
          "Thursday: 7:00 AM – 12:00 AM",
          "Friday: 7:00 AM – 12:00 AM",
          "Saturday: 7:00 AM – 12:00 AM",
          "Sunday: Closed"
        ],
        url: ""
      }
    ];

    document.addEventListener('DOMContentLoaded', () => {
      const searchInput = document.getElementById('searchInput');
      const searchButton = document.getElementById('searchButton');
      const clearSearch = document.getElementById('clearSearch');
      const cardsContainer = document.getElementById('cards-container');

      // Function to get current time in Skopje timezone
      function getSkopjeTime() {
        return new Date(new Date().toLocaleString("en-US", {timeZone: "Europe/Skopje"}));
      }

      // Function to standardize opening hours format (like Diroko's format)
      function standardizeOpeningHours(openingHours) {
        if (!openingHours || openingHours.length === 0) {
          return [];
        }
        
        return openingHours.map(hours => {
          if (hours.includes("Open 24 hours")) {
            return hours.replace("Open 24 hours", "8:00 AM – 10:00 PM");
          }
          return hours;
        });
      }

      function getOpeningHoursStatus(openingHours) {
        const standardizedHours = standardizeOpeningHours(openingHours);
        
        if (!standardizedHours || standardizedHours.length === 0) {
          return { text: "Работно време непознато", color: "text-gray-500" };
        }

        const now = getSkopjeTime();
        const dayOfWeek = now.toLocaleString('en-US', { weekday: 'long' });

        const todayHoursString = standardizedHours.find(h => h.startsWith(dayOfWeek));

        if (!todayHoursString || todayHoursString.includes("Closed")) {
          return { text: "Затворено", color: "text-red-500" };
        }

        try {
          const timeString = todayHoursString.split(': ')[1];
          const [startStr, endStr] = timeString.split(' – ');

          const parseTime = (timeStr) => {
            const date = new Date(now);
            let [time, period] = timeStr.split(' ');
            if(!period) period = time.includes('AM') ? 'AM' : 'PM';
            time = time.replace('AM', '').replace('PM', '');
            let [hours, minutes] = time.split(':');
            hours = parseInt(hours);
            minutes = parseInt(minutes) || 0;

            if (period && period.toUpperCase() === 'PM' && hours < 12) {
              hours += 12;
            }
            if (period && period.toUpperCase() === 'AM' && hours === 12) {
              hours = 0;
            }
            date.setHours(hours, minutes, 0, 0);
            return date;
          };

          const startTime = parseTime(startStr);
          const endTime = parseTime(endStr);
          
          if (endTime < startTime) {
            endTime.setDate(endTime.getDate() + 1);
            if (now < startTime && now.getDate() === startTime.getDate()) {
              now.setDate(now.getDate() + 1);
            }
          }

          if (now < startTime) {
            const hoursUntilOpen = Math.floor((startTime - now) / (1000 * 60 * 60));
            const minutesUntilOpen = Math.floor(((startTime - now) % (1000 * 60 * 60)) / (1000 * 60));
            return { text: `Отвора за ${hoursUntilOpen}ч:${minutesUntilOpen.toString().padStart(2, '0')}мин`, color: "text-blue-500" };
          }

          if (now < endTime) {
            const hoursUntilClose = Math.floor((endTime - now) / (1000 * 60 * 60));
            const minutesUntilClose = Math.floor(((endTime - now) % (1000 * 60 * 60)) / (1000 * 60));
            return { text: `Затвора за ${hoursUntilClose}ч:${minutesUntilClose.toString().padStart(2, '0')}мин`, color: "text-green-600" };
          } else {
            return { text: "Затворено", color: "text-red-500" };
          }

        } catch (e) {
          console.error("Error parsing opening hours: ", e, "for string:", todayHoursString);
          return { text: "Работно време непознато", color: "text-gray-500" };
        }
      }

      // Function to shuffle array (for random display)
      function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
      }

      // Function to get random places with menus for initial display
      function getRandomPlacesWithMenus(count = 6) {
        const placesWithMenus = foodPlaces.filter(place => place.menus && place.menus.length > 0);
        return shuffleArray(placesWithMenus).slice(0, count);
      }

      function createCard(place, searchTerm = '', isSearchResult = false) {
        const card = document.createElement('div');
        card.className = 'card';
        
        const hoursStatus = getOpeningHoursStatus(place.opening_hours);
        const searchTermLower = searchTerm.toLowerCase();
        
        let matchingMenu = null;
        let matchingItem = null;
        let isCategorySearch = false;

        if (searchTerm && place.menus) {
          // Check for category match first
          isCategorySearch = place.menus.some(menu => menu.category.toLowerCase().includes(searchTermLower));
          if (isCategorySearch) {
            matchingMenu = place.menus.find(menu => menu.category.toLowerCase().includes(searchTermLower));
          } else {
            // Check for item match
            for (const menu of place.menus) {
              matchingItem = menu.items.find(item => item.name.toLowerCase().includes(searchTermLower));
              if (matchingItem) {
                matchingMenu = menu;
                break;
              }
            }
          }
        }

        let menuContent = '';
        if (isSearchResult && matchingMenu) {
          if (isCategorySearch) {
            const itemsHtml = matchingMenu.items.map(item => `<div>${item.name}: ${item.price}</div>`).join('');
            menuContent = `
              <div class="expand-button" data-place="${place.name}">
                <span class="expand-triangle"></span>
                <span>${matchingMenu.category}</span>
              </div>
              <div class="menu-items-list" id="menu-list-${place.name.replace(/[^a-zA-Z0-9]/g, '')}">
                ${itemsHtml}
              </div>
            `;
          } else if (matchingItem) {
            menuContent = `<div class="mt-2 font-semibold text-green-700">${matchingItem.name}: ${matchingItem.price}</div>`;
          }
        }

        card.innerHTML = `
          <h3 class="text-lg font-bold text-green-800">${place.name}</h3>
          <p class="text-sm text-gray-600">${place.phone}</p>
          <p class="text-sm font-semibold ${hoursStatus.color}">${hoursStatus.text}</p>
          <a href="https://www.google.com/maps?q=${place.lat},${place.lng}" target="_blank" class="google-maps-link">
            📍 Отвори во Google Maps
          </a>
          ${place.url ? `<br><a href="${place.url}" target="_blank" class="text-blue-500 text-sm hover:underline mt-1 inline-block">🌐 Visit Website</a>` : ''}
          ${menuContent}
        `;

        return card;
      }

      function displayCards(places, searchTerm = '', isSearchResult = false) {
        cardsContainer.innerHTML = '';
        
        if (places.length === 0) {
          cardsContainer.innerHTML = '<p class="text-center text-gray-600 col-span-full">Нема резултати.</p>';
          return;
        }

        places.forEach(place => {
          const card = createCard(place, searchTerm, isSearchResult);
          cardsContainer.appendChild(card);
        });

        // Add event listeners for expand buttons
        document.querySelectorAll('.expand-button').forEach(button => {
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            const container = e.currentTarget;
            const placeName = container.getAttribute('data-place');
            const menuList = document.getElementById(`menu-list-${placeName.replace(/[^a-zA-Z0-9]/g, '')}`);
            
            container.classList.toggle('expanded');
            menuList.classList.toggle('expanded');

            if (menuList.classList.contains('expanded')) {
              menuList.style.maxHeight = menuList.scrollHeight + "px";
            } else {
              menuList.style.maxHeight = '0';
            }
          });
        });
      }

      function performSearch() {
        const query = searchInput.value.toLowerCase().trim();
        
        if (query === '') {
          // Show random places when search is cleared
          displayCards(getRandomPlacesWithMenus());
          return;
        }

        // Search for places that match the query
        const results = foodPlaces.filter(place => {
          const nameMatch = place.name.toLowerCase().includes(query);
          const menuMatch = place.menus && place.menus.some(menu => 
            menu.category.toLowerCase().includes(query) || 
            menu.items.some(item => item.name.toLowerCase().includes(query))
          );
          return nameMatch || menuMatch;
        });

        // Remove duplicates for category searches (e.g., "Пица")
        const uniqueResults = results.filter((place, index, self) => 
          index === self.findIndex(p => p.name === place.name)
        );

        displayCards(uniqueResults, query, true);
      }

      // Event listeners
      searchButton.addEventListener('click', performSearch);
      searchInput.addEventListener('keyup', (e) => {
        if (e.key === 'Enter') {
          performSearch();
        }
      });
      clearSearch.addEventListener('click', () => {
        searchInput.value = '';
        displayCards(getRandomPlacesWithMenus());
      });

      // Initial display: show random places with menus
      displayCards(getRandomPlacesWithMenus());
    });
  </script>
</body>
</html>